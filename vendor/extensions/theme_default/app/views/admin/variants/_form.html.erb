<div class="yui-gb">
  <div class="yui-u first">

    <% @product.options.each do |option| %>
      <p>
        <%= label :new_variant, option.option_type.presentation %><br />
        <% if @variant.new_record? %>
          <%= select(:new_variant, option.option_type.presentation,
            option.option_type.option_values.collect {|ov| [ ov.presentation, ov.id ] },
            {})
          %>
        <% else %>
          <% opt = @variant.option_values.detect {|o| o.option_type == option.option_type }.presentation %>
          <%= text_field(:new_variant,  option.option_type.presentation, :value => opt, :disabled => 'disabled') %>
        <% end %>
      </p>
    <% end %>

    <p><%= f.label :sku, t("sku") %><br />
    <%= f.text_field :sku %></p>

		<p><%= f.label :prices, t("prices") %>: <br/>
			<%=  select_tag("currency_id", options_for_select(Currency.all.collect {|c| [ c.name, c.id ] }, @default_currency.id), :style => "float:left;width:100px;margin-right:16px;") %>
			<% f.fields_for :prices do |price_form| %>
				<span id="price_for_<%= price_form.object.currency_id %>" style="display:<%= price_form.object.currency.default ? "block" : "none" %>;">
					<%= price_form.text_field :amount, :style => "float:left;width:100px;" %>
					<%= price_form.hidden_field :currency_id %>
				</span>
			<% end %>
		</p>

    <p><%= f.label :cost_price, t("cost_price") %>:<br />
    <%= f.text_field :cost_price, :value => number_with_precision(@variant.cost_price, 2) %></p>

    <p><%= f.label :on_hand, t("on_hand") %>: <br />
    <%= f.text_field :on_hand %></p>
  </div>
  <div class="yui-u">

    <% Variant.additional_fields.select{|af| af[:only].nil? || af[:only].include?(:variant) }.each do |field| %>
      <%= render :partial => "admin/shared/additional_field", :locals => {:field => field, :f => f} %>
    <% end %>

  </div>
</div>

<% content_for :head do %>
	<script type="text/javascript">
		jQuery(document).ready(function(){
			var selected_price = <%= @default_currency.id %>;

			jQuery("select[name='currency_id']").change(function(){
				jQuery("#price_for_" + this.value).show();

				jQuery("#price_for_" + selected_price).hide();
				selected_price = this.value;
			});

		});
	</script>
<% end %>